# 密钥与密钥对说明

本项目中可能用到的几类「密钥」及创建方式如下。

---

## 一、SSH 密钥对（登录阿里云等服务器用）

用于**无密码 SSH 登录**云服务器（如阿里云 ECS），本地生成一对：**私钥**留在本机，**公钥**上传到服务器或填入云控制台。

### 1. 在本机生成 SSH 密钥对

在**你自己的电脑**上打开终端执行：

```bash
ssh-keygen -t ed25519 -C "你的邮箱或备注"
```

- 提示「Enter file in which to save the key」时直接回车，使用默认路径（如 `~/.ssh/id_ed25519`）。
- 提示「Enter passphrase」时可回车留空，或设一个密码（更安全）。

生成后得到两个文件（默认在 `~/.ssh/` 下）：

- **私钥**：`id_ed25519`（不要发给任何人，不要上传到网上）
- **公钥**：`id_ed25519.pub`（可以给服务器或填到阿里云）

### 2. 在阿里云 ECS 里使用

**方式 A：创建实例时绑定密钥对**

1. 阿里云 ECS 控制台 → **密钥对**（或 网络与安全 → 密钥对）→ **创建密钥对**。
2. 输入密钥对名称，选择「自动新建」则阿里云会生成并让你下载私钥；或选择「导入已有」，粘贴你本机 `~/.ssh/id_ed25519.pub` 的内容（公钥）。
3. 创建实例时，在「登录凭证」里选择 **密钥对**，并选择刚创建/导入的密钥对。
4. 实例创建后，用**本机私钥**登录（若你选的是「导入已有」，就用你本机生成的私钥）：

```bash
ssh -i ~/.ssh/id_ed25519 root@你的ECS公网IP
```

**方式 B：实例已用密码创建，想改用密钥登录**

1. 在本机查看公钥内容：`cat ~/.ssh/id_ed25519.pub`，复制整行。
2. SSH 用密码登录到 ECS 后，执行：
   ```bash
   mkdir -p ~/.ssh
   echo "这里粘贴你的公钥内容" >> ~/.ssh/authorized_keys
   chmod 600 ~/.ssh/authorized_keys
   ```
3. 退出后，用 `ssh root@你的ECS公网IP` 即可免密登录（若私钥在默认路径）。

---

## 二、API 密钥（Lumi 调用模型用）

Lumi 需要至少配置一种**模型 API 密钥**（如 DeepSeek、阿里云 DashScope），这些是在**对方网站控制台**里「创建」得到的，不是在本机生成的密钥对。

| 用途       | 去哪里创建 | 环境变量名 |
|------------|------------|------------|
| DeepSeek   | [DeepSeek 开放平台](https://platform.deepseek.com/) → API Keys | `DEEPSEEK_API_KEY` |
| 阿里云 DashScope | [阿里云 DashScope 控制台](https://dashscope.console.aliyun.com/) → API-KEY 管理 | `DASHSCOPE_API_KEY` |
| 自建/本地 Qwen | 由部署方提供 token | `QWEN_API_KEY`、`QWEN_API_BASE` |

创建后把得到的密钥**只填到环境变量或 .env**，不要写进代码、不要提交到仓库。

---

## 三、Lumi 开发者认证密钥（开发者调试页用）

「开发者调试」页里的「开发者认证」使用的是**一个共享密钥**：用户输入与服务器配置的**一致**即通过，不是公钥/私钥对。

- **服务端配置**：在运行 Lumi 的机器上设置环境变量  
  `LUMI_DEV_SECRET=你设定的密钥字符串`  
  若不设置，代码里有一个默认值（仅用于开发/自用，建议自建部署时改为自己的）。
- **用户操作**：在「开发者调试」→「开发者认证」输入框中输入**同一个**密钥，点击认证。

也就是说：**你只要自己定一个字符串（如随机一串字母数字），在服务器上设为 `LUMI_DEV_SECRET`，在页面上输入同一字符串即可通过认证。** 不需要在本机「创建密钥对」。

---

## 小结

| 类型           | 是否「密钥对」 | 创建/使用方式 |
|----------------|----------------|----------------|
| SSH 登录服务器 | 是（公钥+私钥）| 本机 `ssh-keygen` 生成，公钥给阿里云或写入 ECS `authorized_keys` |
| 模型 API 密钥  | 否（单密钥）   | 在 DeepSeek / 阿里云等控制台「创建」并复制，填到环境变量 |
| Lumi 开发者认证| 否（共享密钥） | 自定一个字符串，设成 `LUMI_DEV_SECRET`，页面输入同一字符串 |

若你指的是**登录阿里云 ECS 的密钥对**，按「一、SSH 密钥对」操作即可；若是**API 密钥**或**开发者认证**，按二或三即可。

更多说明见 [README.md](README.md)、[功能介绍.md](功能介绍.md)。
